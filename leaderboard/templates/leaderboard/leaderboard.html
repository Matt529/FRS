{% extends 'FRS/base_template.html' %}
{% load get_from_dict %}

{% block body %}
    <table class="uk-table">
        <caption>Team Leaderboard</caption>
        <thead>
        <tr>
            <th>Stat</th>
            <th>Leader</th>
            <th>Value</th>
        </tr>
        </thead>
        <tbody>
        {% for key, value in team_top.items %}
            {% if value.0 != None %}
                <tr>
                    <td>
                        {% if value.1 != '' %}
                            <a href="{{ value.1 }}">{{ key }}</a>
                        {% else %}
                            {{ key }}
                        {% endif %}
                    </td>
                    <td><a href="{% url 'team_view' value.0.team_number %}">{{ value.0 }}</a></td>
                    <td>{{ value.0.stat|floatformat:"-2" }}</td>
                </tr>
            {% endif %}
        {% endfor %}
        </tbody>
    </table>

    <table class="uk-table">
        <caption>Alliance Leaderboard</caption>
        <thead>
        <tr>
            <th>Stat</th>
            <th>Leader</th>
            <th>Value</th>
        </tr>
        </thead>
        <tbody>

        {% comment %}
            I'm not proud of any of this. To fix this, we need to find a way to use annotation in
            leaderboard.models.alltime.AllianceLeaderboard functions.
        {% endcomment %}
        {# All time event wins (3), this needs serious overhaul #}
        {% with alliance_top|get_from_dict:"All-time Event Wins (3)" as value %}
            <tr>
                <td><a href="{{ value.1 }}">All-time Event Wins (3)</a></td>
                <td>
                    {% comment %}
                    It "has" to be done this way because of how the user can input 3 team numbers as a URL for the
                    alliance view. There is probably a way around this but it's not on my immediate radar.
                    {% endcomment %}
                    <a href="{% url 'alliance_view' value.0.0.0.teams.all.0.team_number value.0.0.0.teams.all.1.team_number value.0.0.0.teams.all.2.team_number %}">
                        {{ value.0.0.0.teams.all|join:", " }}</a></td>
                <td>{{ value.0.0.1 }}</td>
            </tr>
        {% endwith %}
        {% with alliance_top|get_from_dict:"All-time Event Wins (2)" as value %}
            <tr>
                <td><a href="{{ value.1 }}">All-time Event Wins (2)</a></td>
                <td>
                    <a href="{% url 'team_view' value.0.0.0.0.team_number %}">{{ value.0.0.0.0 }}</a>,
                    <a href="{% url 'team_view' value.0.0.0.1.team_number %}">{{ value.0.0.0.1 }}</a>
                </td>
                <td>{{ value.0.0.1 }}</td>
            </tr>
        {% endwith %}
        </tbody>
    </table>


{% endblock %}
